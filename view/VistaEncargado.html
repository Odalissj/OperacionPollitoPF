<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gestión de Encargados | Pollito</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <link rel="stylesheet" href="../css/index.css" />
    <link rel="stylesheet" href="../css/navbar.css" />
  </head>
  <body>
    <header data-include="/view/partials/navbar.html"></header>

    <main class="container mb-5">
      <div
        class="mb-5 p-3 border rounded shadow-sm d-flex justify-content-center"
      >
        <div class="d-flex gap-3">
          <button
            type="button"
            class="btn btn-azul btn-lg"
            data-bs-toggle="modal"
            data-bs-target="#modalCrearEncargado"
          >
            <i class="bi bi-person-plus-fill"></i> Nuevo Encargado
          </button>

          <button
            type="button"
            class="btn btn-warning btn-lg"
            data-bs-toggle="modal"
            data-bs-target="#modalActualizarEncargado"
          >
            <i class="bi bi-pencil-square"></i> Actualizar Encargado
          </button>

          <button
            type="button"
            class="btn btn-info btn-lg"
            data-bs-toggle="modal"
            data-bs-target="#modalReportes"
          >
            <i class="bi bi-file-earmark-bar-graph-fill"></i> Reportes
          </button>
        </div>
      </div>

      <div
        class="modal fade"
        id="modalReportes"
        tabindex="-1"
        aria-labelledby="modalReportesLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modalReportesLabel">
                Generar Reportes de Encargados
              </h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <button
                type="button"
                class="btn btn-primary w-100 mb-3"
                id="btnReporteTodos"
              >
                <i class="bi bi-file-earmark-pdf-fill"></i> Reporte todos los
                Encargados (Imprimible)
              </button>

              <hr />

              <h6>Filtro de Ubicación (Reporte Detallado)</h6>

              <div class="row mb-3">
                <div class="col-md-6 mb-3">
                  <label for="filtroPais" class="form-label">País</label>
                  <select class="form-select" id="filtroPais"></select>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="filtroDepartamento" class="form-label"
                    >Departamento</label
                  >
                  <select
                    class="form-select"
                    id="filtroDepartamento"
                    disabled
                  ></select>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="filtroMunicipio" class="form-label"
                    >Municipio</label
                  >
                  <select
                    class="form-select"
                    id="filtroMunicipio"
                    disabled
                  ></select>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="filtroLugar" class="form-label">Lugar</label>
                  <select
                    class="form-select"
                    id="filtroLugar"
                    disabled
                  ></select>
                </div>
              </div>

              <button
                type="button"
                class="btn btn-secondary w-100"
                id="btnReporteGenerarFiltro"
              >
                <i class="bi bi-geo-alt-fill"></i> Generar Reporte por Ubicación
                (Imprimible)
              </button>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cerrar
              </button>
            </div>
          </div>
        </div>
      </div>

      <div
        class="modal fade"
        id="modalCrearEncargado"
        tabindex="-1"
        aria-labelledby="modalCrearEncargadoLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-xl">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modalCrearEncargadoLabel">
                Registrar Nuevo Encargado
              </h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div id="seccionDpiCrear">
                <div class="mb-3">
                  <label for="dpiCrear" class="form-label"
                    >DPI / Identificación del Encargado</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="dpiCrear"
                    placeholder="Ingrese el DPI"
                    required
                  />
                </div>
                <button
                  type="button"
                  class="btn btn-success"
                  id="btnVerificarDpiCrear"
                >
                  Validar Encargado
                </button>
                <p id="mensajeDpiCrear" class="mt-2 fw-bold"></p>
              </div>

              <div id="formularioCrear" class="mt-4 border p-3 rounded d-none">
                <form id="formCrearEncargado">
                  <input type="hidden" id="IdentificacionEncargaCrear" />

                  <div class="row mb-3">
                    <div class="col-md-3">
                      <label for="nombre1EncargadoCrear" class="form-label req"
                        >Primer Nombre <span class="text-danger">*</span></label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="nombre1EncargadoCrear"
                        required
                      />
                    </div>
                    <div class="col-md-3">
                      <label for="nombre2EncargadoCrear" class="form-label"
                        >Segundo Nombre</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="nombre2EncargadoCrear"
                      />
                    </div>
                    <div class="col-md-3">
                      <label for="nombre3EncargadoCrear" class="form-label"
                        >Tercer Nombre</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="nombre3EncargadoCrear"
                      />
                    </div>
                    <div class="col-md-3">
                      <label
                        for="apellido1EncargadoCrear"
                        class="form-label req"
                        >Primer Apellido
                        <span class="text-danger">*</span></label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="apellido1EncargadoCrear"
                        required
                      />
                    </div>
                  </div>

                  <div class="row mb-3">
                    <div class="col-md-3">
                      <label for="apellido2EncargadoCrear" class="form-label"
                        >Segundo Apellido</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="apellido2EncargadoCrear"
                      />
                    </div>
                    <div class="col-md-3">
                      <label for="apellido3EncargadoCrear" class="form-label"
                        >Tercer Apellido</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="apellido3EncargadoCrear"
                      />
                    </div>
                    <div class="col-md-3">
                      <label for="telefonoEncargadoCrear" class="form-label"
                        >Teléfono</label
                      >
                      <input
                        type="tel"
                        class="form-control"
                        id="telefonoEncargadoCrear"
                      />
                    </div>
                    <div class="col-md-3">
                      <label for="correoEncargadoCrear" class="form-label"
                        >Correo Electrónico</label
                      >
                      <input
                        type="email"
                        class="form-control"
                        id="correoEncargadoCrear"
                      />
                    </div>
                  </div>

                  <hr />
                  <h6>Ubicación del Encargado (Cascada)</h6>
                  <div class="row mb-3">
                    <div class="col-md-3">
                      <label for="idPaisBeneCrear" class="form-label"
                        >País</label
                      >
                      <select class="form-select" id="idPaisBeneCrear"></select>
                    </div>
                    <div class="col-md-3">
                      <label for="idDepartamentoBeneCrear" class="form-label"
                        >Departamento</label
                      >
                      <select
                        class="form-select"
                        id="idDepartamentoBeneCrear"
                        disabled
                      ></select>
                    </div>
                    <div class="col-md-3">
                      <label for="idMunicipioBeneCrear" class="form-label"
                        >Municipio</label
                      >
                      <select
                        class="form-select"
                        id="idMunicipioBeneCrear"
                        disabled
                      ></select>
                    </div>
                    <div class="col-md-3">
                      <label for="idLugarEncargadoCrear" class="form-label req"
                        >Lugar <span class="text-danger">*</span></label
                      >
                      <select
                        class="form-select"
                        id="idLugarEncargadoCrear"
                        required
                        disabled
                      ></select>
                    </div>
                  </div>

                  <!-- Auditoría oculta (se llena por JS) -->
<input type="hidden" id="fechaIngresoEncargaCrear" />
<input type="hidden" id="horaIngresoEncargaCrear" />
<input type="hidden" id="idUsuarioIngresoCrear" />

                </form>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cerrar
              </button>
              <button
                type="submit"
                class="btn btn-azul"
                form="formCrearEncargado"
                id="btnGuardarCrear"
                disabled
              >
                Guardar Encargado
              </button>
            </div>
          </div>
        </div>
      </div>

      <div
        class="modal fade"
        id="modalActualizarEncargado"
        tabindex="-1"
        aria-labelledby="modalActualizarEncargadoLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-xl">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modalActualizarEncargadoLabel">
                Actualizar Encargado
              </h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div id="seccionDpiActualizar">
                <div class="mb-3">
                  <label for="dpiActualizar" class="form-label"
                    >DPI / Identificación del Encargado</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="dpiActualizar"
                    placeholder="Ingrese el DPI del encargado a actualizar"
                    required
                  />
                </div>
                <button
                  type="button"
                  class="btn btn-success"
                  id="btnVerificarDpiActualizar"
                >
                  Buscar Encargado
                </button>
                <p id="mensajeDpiActualizar" class="mt-2 fw-bold"></p>
              </div>

              <div
                id="formularioActualizar"
                class="mt-4 border p-3 rounded d-none"
              >
                <div
                  id="infoEncargadoActualizar"
                  class="alert alert-primary mb-3"
                  role="alert"
                >
                  <small class="mb-0">Buscando encargado...</small>
                </div>

                <form id="formActualizarEncargado">
                  <input type="hidden" id="idEncargadoActualizar" />

                

                  <div class="row mb-3">
                    <div class="col-md-3">
                      <label
                        for="nombre1EncargadoActualizar"
                        class="form-label req"
                        >Primer Nombre <span class="text-danger">*</span></label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="nombre1EncargadoActualizar"
                        required
                      />
                    </div>
                    <div class="col-md-3">
                      <label for="nombre2EncargadoActualizar" class="form-label"
                        >Segundo Nombre</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="nombre2EncargadoActualizar"
                      />
                    </div>
                    <div class="col-md-3">
                      <label for="nombre3EncargadoActualizar" class="form-label"
                        >Tercer Nombre</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="nombre3EncargadoActualizar"
                      />
                    </div>
                    <div class="col-md-3">
                      <label
                        for="apellido1EncargadoActualizar"
                        class="form-label req"
                        >Primer Apellido
                        <span class="text-danger">*</span></label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="apellido1EncargadoActualizar"
                        required
                      />
                    </div>
                  </div>

                  <div class="row mb-3">
                    <div class="col-md-3">
                      <label
                        for="apellido2EncargadoActualizar"
                        class="form-label"
                        >Segundo Apellido</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="apellido2EncargadoActualizar"
                      />
                    </div>
                    <div class="col-md-3">
                      <label
                        for="apellido3EncargadoActualizar"
                        class="form-label"
                        >Tercer Apellido</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="apellido3EncargadoActualizar"
                      />
                    </div>
                    <div class="col-md-3">
                      <label
                        for="telefonoEncargadoActualizar"
                        class="form-label"
                        >Teléfono</label
                      >
                      <input
                        type="tel"
                        class="form-control"
                        id="telefonoEncargadoActualizar"
                      />
                    </div>
                    <div class="col-md-3">
                      <label for="correoEncargadoActualizar" class="form-label"
                        >Correo Electrónico</label
                      >
                      <input
                        type="email"
                        class="form-control"
                        id="correoEncargadoActualizar"
                      />
                    </div>
                  </div>

                  <hr />
                  <h6>Ubicación del Encargado</h6>
                  <div class="row mb-3">
                    <div class="col-md-3">
                      <label for="idPaisBeneActualizar" class="form-label"
                        >País</label
                      >
                      <select
                        class="form-select"
                        id="idPaisBeneActualizar"
                      ></select>
                    </div>
                    <div class="col-md-3">
                      <label
                        for="idDepartamentoBeneActualizar"
                        class="form-label"
                        >Departamento</label
                      >
                      <select
                        class="form-select"
                        id="idDepartamentoBeneActualizar"
                        disabled
                      ></select>
                    </div>
                    <div class="col-md-3">
                      <label for="idMunicipioBeneActualizar" class="form-label"
                        >Municipio</label
                      >
                      <select
                        class="form-select"
                        id="idMunicipioBeneActualizar"
                        disabled
                      ></select>
                    </div>
                    <div class="col-md-3">
                      <label
                        for="idLugarEncargadoActualizar"
                        class="form-label req"
                        >Lugar <span class="text-danger">*</span></label
                      >
                      <select
                        class="form-select"
                        id="idLugarEncargadoActualizar"
                        required
                        disabled
                      ></select>
                    </div>
                  </div>

                  <!-- Datos de actualización ocultos: fecha/hora/usuario -->
                  <input type="hidden" id="fechaActualizacionActualizar" />
                  <input type="hidden" id="horaActualizacionActualizar" />
                  <input type="hidden" id="idUsuarioActualizaActualizar" />
                </form>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cerrar
              </button>
              <button
                type="submit"
                class="btn btn-naranja"
                form="formActualizarEncargado"
                id="btnGuardarActualizar"
                disabled
              >
                Guardar Cambios
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>
    <div data-include="/view/partials/footer.html"></div>

    <script src="/js/include.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script src="../js/auth.js"></script>
    <script src="../js/Encargado.js"></script>
    <script src="../js/CargaUsuarios.js"></script>
  </body>
</html>
